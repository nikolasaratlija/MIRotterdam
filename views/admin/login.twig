{% extends 'base/layout.twig' %}

{% block body %}

    <!--Form gemaakt mbv bootstrap en een knop die verwijst naar loginfunctie-->
    <div class="form-signin" style="text-align: center;">
            <img class="mb-4" src="/assets/img/MIR-Logo.jpg" alt="Logo" width="auto" height="60">
            <h1 class="h3 mb-3 fw-normal">Log In</h1>

            <div class="form-floating">
                <input type="text" class="form-control" id="email" placeholder="admin" name="email" required>
                <label for="floatingInput">E-mailadres</label>
            </div>
            <div class="form-floating">
                <input type="password" class="form-control" id="wachtwoord" placeholder="Password" name="wachtwoord" required>
                <label for="floatingPassword">Wachtwoord</label>
            </div>
            <div class="form-group">
                <input type="checkbox" onclick="showPass()" id="checkpass">
                <label for="checkpass" class="col-form-label">Toon wachtwoord</label><br>
            </div>

            <button class="w-100 btn btn-lg btn-success" id="login-button" type="submit" name="LoginButton">Log In</button>

            <p class="d-none text-danger" id="fout">Uw gegevens kloppen niet</p>

            <p class="mt-5 mb-3 text-muted">MiRotterdam - 2021</p>
    </div>

    <script>
        //Functie die zorgt dat de type van het inputveld veranderd.
        function showPass() {
            var x = document.getElementById("wachtwoord");
            if (x.type === "password") {
                x.type = "text";
            } else {
                x.type = "password";
            }
        }

        //Heeft door ofdat de knop aangeklikt wordt, pakt de waardes van de input en schrijft die naar JSON.
        document.getElementById('login-button').addEventListener('click', () => {
            const data = {
                'wachtwoord': document.getElementById('wachtwoord').value,
                'email': document.getElementById('email').value
            }

            fetch('/admin', {
                method: "post",
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            })
                .then(data => data.json())
                .then(json => {
                    if (json.data === false){
                        document.getElementById('fout').classList.remove('d-none')
                    }
                    else {
                        window.location.href = '/admin/dashboard'
                    }
                })
        })
    </script>

{% endblock %}